{
  "description": "Identity and access management for the cloud using Azure Active Directory REST API services.",
  "category": "Identity and Access Management",
  "name": "azure-active-directory",
  "label": "Azure Active Directory",
  "version": "2.2.0",
  "publisher": "Fortinet",
  "cs_approved": true,
  "cs_compatible": true,
  "icon_small_name": "small-azure.png",
  "icon_large_name": "large-azure.png",
  "help_online": "https://docs.fortinet.com/document/fortisoar/2.2.0/azure-active-directory/592/azure-active-directory-v2-2-0",
  "configuration": {
    "fields": [
      {
        "title": "Access Token Type",
        "required": true,
        "editable": true,
        "visible": true,
        "type": "select",
        "options": [
          "On behalf of User - Delegate Permission",
          "Without a User - Application Permission"
        ],
        "name": "auth_type",
        "value": "Without a User - Application Permission",
        "description": "Select the method using which you will get authentication tokens used to access the security graph APIs. You can choose between On behalf of User – Delegate Permission or Without a User - Application Permission.",
        "onchange": {
          "Without a User - Application Permission": [
            {
              "title": "Server URL",
              "required": true,
              "editable": true,
              "visible": true,
              "type": "text",
              "name": "resource",
              "value": "https://graph.microsoft.com",
              "description": "The service-based URI to which you will connect and perform the automated operations."
            },
            {
              "title": "Client ID",
              "required": true,
              "editable": true,
              "visible": true,
              "type": "text",
              "name": "client_id",
              "description": "Unique Application ID of the Azure Active Directory application that is used to create an authentication token required to access the API."
            },
            {
              "title": "Client Secret",
              "required": true,
              "editable": true,
              "visible": true,
              "type": "password",
              "name": "client_secret",
              "description": "Unique Client Secret of the Azure Active Directory application that is used to create an authentication token required to access the API. For information on how to get the secret key, see 'https://docs.microsoft.com/en-us/windows/security/threat-protection/microsoft-defender-atp/exposed-apis-create-app-webapp'."
            },
            {
              "title": "Tenant ID",
              "required": true,
              "editable": true,
              "visible": true,
              "type": "text",
              "name": "tenant_id",
              "description": "ID of the tenant that you have been provided for your Azure Active Directory instance."
            },
            {
              "title": "Verify SSL",
              "required": false,
              "editable": true,
              "visible": true,
              "type": "checkbox",
              "name": "verify_ssl",
              "value": true,
              "description": "Specifies whether the SSL certificate for the server is to be verified or not. By default, this option is set as True."
            }
          ],
          "On behalf of User - Delegate Permission": [
            {
              "title": "Server URL",
              "required": true,
              "editable": true,
              "visible": true,
              "type": "text",
              "name": "resource",
              "value": "https://graph.microsoft.com",
              "description": "The service-based URI to which you will connect and perform the automated operations."
            },
            {
              "title": "Client ID",
              "required": true,
              "editable": true,
              "visible": true,
              "type": "text",
              "name": "client_id",
              "description": "Unique API ID of the Azure Active Directory application that is used to create an authentication token required to access the API."
            },
            {
              "title": "Client Secret",
              "required": true,
              "editable": true,
              "visible": true,
              "type": "password",
              "name": "client_secret",
              "description": "Unique API Secret of the Azure Active Directory application that is used to create an authentication token required to access the API. For information on how to get the secret key, see 'https://docs.microsoft.com/en-us/windows/security/threat-protection/microsoft-defender-atp/exposed-apis-create-app-webapp'."
            },
            {
              "title": "Tenant ID",
              "required": true,
              "editable": true,
              "visible": true,
              "type": "text",
              "name": "tenant_id",
              "description": "ID of the tenant that you have been provided for your Azure Active Directory instance."
            },
            {
              "title": "Authorization Code",
              "required": true,
              "editable": true,
              "visible": true,
              "type": "password",
              "name": "code",
              "tooltip": "Authorization code that you acquired in the authorization step.",
              "description": "(Only Applicable to On behalf of User – Delegate Permission) The authorization code that you acquired during the authorization step. For more information, see the Getting Access Tokens using the Delegate Permissions method section."
            },
            {
              "title": "Redirect URL",
              "description": "The redirect_uri of your app, where authentication responses can be sent and received by your app. It must exactly match one of the redirect_uri's you registered in the app registration portal.",
              "required": false,
              "editable": true,
              "visible": true,
              "type": "text",
              "name": "redirect_url",
              "placeholder": "E.g. https://localhost/myapp",
              "tooltip": "(Only Applicable to On behalf of User – Delegate Permission) The redirect_uri of your app, where authentication responses can be sent and received by your app. The redirect URL that you specify here must exactly match one of the redirect_uri's you have registered in your app registration portal."
            },
            {
              "title": "Verify SSL",
              "required": false,
              "editable": true,
              "visible": true,
              "type": "checkbox",
              "name": "verify_ssl",
              "value": true,
              "description": "Specifies whether the SSL certificate for the server is to be verified or not. By default, this option is set as True."
            }
          ]
        }
      }
    ]
  },
  "operations": [
    {
      "title": "Get User Membership",
      "operation": "get_user_membership",
      "description": "Retrieves groups, directory roles, and administrative units of which the user is a direct member. ",
      "category": "enrichment",
      "annotation": "get_user_membership",
      "output_schema": {
        "value": [
          {
            "@odata.type": "",
            "displayName": "",
            "mailEnabled": "",
            "securityEnabled": ""
          }
        ]
      },
      "parameters": [
        {
          "title": "User ID",
          "name": "user_id",
          "type": "text",
          "tooltip": "User ID or principal name",
          "description": "Specify the user ID or the principal name of the user whose group memberships to fetch.",
          "required": true,
          "editable": true,
          "visible": true
        },
        {
          "title": "Membership Type",
          "name": "membership_type",
          "type": "select",
          "tooltip": "Type of group membership to retrieve: direct or transitive",
          "description": "Select the type of group membership to retrieve from following options: direct or transitive",
          "required": true,
          "editable": true,
          "visible": true,
          "options": [
            "Direct",
            "Transitive"
          ],
          "value": "Direct"
        }
      ],
      "enabled": true
    },
    {
      "title": "Get People",
      "operation": "get_people",
      "description": "Retrieves a collection of person objects in order of their relevance to the user, determined by the user's communication, collaboration patterns, and business relationships. ",
      "category": "enrichment",
      "annotation": "get_people",
      "output_schema": {
        "value": [
          {
            "id": "",
            "displayName": "",
            "givenName": "",
            "surname": "",
            "birthday": "",
            "personNotes": "",
            "isFavorite": "",
            "jobTitle": "",
            "companyName": "",
            "yomiCompany": "",
            "department": "",
            "officeLocation": "",
            "profession": "",
            "userPrincipalName": "",
            "imAddress": "",
            "scoredEmailAddresses": [
              {
                "address": "",
                "relevanceScore": ""
              }
            ],
            "phones": "",
            "postalAddresses": "",
            "websites": "",
            "personType": {
              "class": "",
              "subclass": ""
            }
          },
          {
            "id": "",
            "displayName": "",
            "givenName": "",
            "surname": "",
            "birthday": "",
            "personNotes": "",
            "isFavorite": "",
            "jobTitle": "",
            "companyName": "",
            "yomiCompany": "",
            "department": "",
            "officeLocation": "",
            "profession": "",
            "userPrincipalName": "",
            "imAddress": "",
            "scoredEmailAddresses": [
              {
                "address": "",
                "relevanceScore": ""
              }
            ],
            "phones": [
              {
                "type": "",
                "number": ""
              }
            ],
            "postalAddresses": "",
            "websites": "",
            "personType": {
              "class": "",
              "subclass": ""
            }
          }
        ]
      },
      "parameters": [
        {
          "title": "User ID",
          "name": "user_id",
          "type": "text",
          "tooltip": "User ID or principal name",
          "description": "Specify the user ID or the principal name of the user for which to fetch the people records.",
          "required": true,
          "editable": true,
          "visible": true
        },
        {
          "title": "Filter Query",
          "description": "Specify the filter query based on which to retrieve people. Refer to Azure Filter Query Parameters for information on the filter query syntax.",
          "required": false,
          "editable": true,
          "visible": true,
          "type": "text",
          "name": "$filter",
          "placeholder": "",
          "tooltip": "Filter query based on which you want to retrieve records as documented at https://learn.microsoft.com/en-us/graph/filter-query-parameter"
        },
        {
          "title": "Select Query",
          "description": "Specify the $select query to retrieve people from Azure Active Directory. The OData's Select query is supported on fields such as id, displayName, etc. Refer to OData system query options for more information. ",
          "required": false,
          "editable": true,
          "visible": true,
          "type": "text",
          "name": "$select",
          "placeholder": "",
          "tooltip": "Comma-separated list of properties to include in the response. For optimal performance, only select the subset of properties needed."
        },
        {
          "title": "Number Of Records To Fetch",
          "required": false,
          "editable": true,
          "visible": true,
          "type": "integer",
          "name": "$top",
          "description": "(Optional) Specify the maximum number of records that this operation should return from Azure. ",
          "tooltip": "(Optional) Specify the maximum number of records that this operation should return from Azure."
        },
        {
          "title": "Offset",
          "required": false,
          "editable": true,
          "visible": true,
          "type": "integer",
          "name": "$skip",
          "description": "(Optional) Specify the count of the first few records to skip while retrieving response from Azure Active Directory.",
          "tooltip": "(Optional) Skip the first n results, useful for paging."
        }
      ],
      "enabled": true
    },
    {
      "title": "Get Managers",
      "operation": "get_managers",
      "description": "Retrieves the chain of managers for a specified user. ",
      "category": "enrichment",
      "annotation": "get_managers",
      "output_schema": {
        "id": "",
        "displayName": "",
        "manager": {
          "id": "",
          "displayName": "",
          "manager": {
            "id": "",
            "displayName": "",
            "manager": {
              "id": "",
              "displayName": ""
            }
          }
        }
      },
      "parameters": [
        {
          "title": "User ID",
          "name": "user_id",
          "type": "text",
          "tooltip": "User ID or principal name",
          "description": "Specify the user ID or the principal name of the user for whom to fetch the managers list. ",
          "required": true,
          "editable": true,
          "visible": true
        }
      ],
      "enabled": true
    },
    {
      "title": "Revoke SignIn Sessions",
      "operation": "revoke_sign_in_sessions",
      "description": "Invalidates all the refresh tokens issued to applications for a user. Action typically performed if the user's device is lost or stolen. ",
      "category": "response",
      "annotation": "revoke_sign_in_sessions",
      "output_schema": {
        "@odata.context": "",
        "value": ""
      },
      "parameters": [
        {
          "title": "User ID",
          "name": "user_id",
          "type": "text",
          "tooltip": "User ID or principal name",
          "description": "Specify the user ID or the principal name of the user for whom to revoke all sign in sessions.",
          "required": true,
          "editable": true,
          "visible": true
        }
      ],
      "enabled": true
    },
    {
      "title": "List Direct Reports",
      "operation": "list_direct_reports",
      "description": "Retrieves the direct reports for the specified user. ",
      "category": "investigation",
      "annotation": "list_direct_reports",
      "output_schema": {
        "@odata.context": "",
        "value": [
          {
            "@odata.type": "",
            "id": "",
            "businessPhones": "",
            "displayName": "",
            "givenName": "",
            "jobTitle": "",
            "mail": "",
            "mobilePhone": "",
            "officeLocation": "",
            "preferredLanguage": "",
            "surname": "",
            "userPrincipalName": ""
          }
        ]
      },
      "parameters": [
        {
          "title": "User ID",
          "name": "user_id",
          "type": "text",
          "tooltip": "User ID or principal name",
          "description": "Specify the user ID or the principal name of the user for whom to fetch the direct reports. ",
          "required": true,
          "editable": true,
          "visible": true
        }
      ],
      "enabled": true
    },
    {
      "title": "List Devices",
      "operation": "list_devices",
      "description": "Retrieves a list of device objects registered in the organization. ",
      "category": "investigation",
      "annotation": "list_devices",
      "output_schema": {
        "value": [
          {
            "accountEnabled": "",
            "deviceId": "",
            "deviceVersion": "",
            "displayName": "",
            "Manufacturer": "",
            "Model": "",
            "operatingSystemVersion": ""
          }
        ]
      },
      "parameters": [
        {
          "title": "Filter Query",
          "description": "Specify the filter query based on which to retrieve the list of devices. Refer to Azure Filter Query Parameters for information on the filter query syntax. ",
          "required": false,
          "editable": true,
          "visible": true,
          "type": "text",
          "name": "$filter",
          "placeholder": "displayName eq 'DESKTOP-LK3PESR'",
          "tooltip": "Filter query based on which you want to retrieve records as documented at https://learn.microsoft.com/en-us/graph/filter-query-parameter"
        },
        {
          "title": "Select Query",
          "description": "Specify the $select query to retrieve people from Azure Active Directory. The OData's Select query is supported on fields such as id, displayName, etc. Refer to OData system query options for more information. ",
          "required": false,
          "editable": true,
          "visible": true,
          "type": "text",
          "name": "$select",
          "placeholder": "id,displayName",
          "tooltip": "Specify the select query to retrieve records from Azure Active Directory. The OData's Select query is supported on fields such as: \"id\", \"displayName\", etc."
        },
        {
          "title": "Number Of Records To Fetch",
          "required": false,
          "editable": true,
          "visible": true,
          "type": "integer",
          "name": "$top",
          "description": "(Optional) Specify the maximum number of records that this operation should return from Azure. "
        },
        {
          "title": "Get All Pages",
          "name": "get_all_pages",
          "type": "checkbox",
          "tooltip": "If you select this option, i.e., set it to true, all pages will be fetched from azure so the action will return all available records.",
          "description": "Select this option, i.e., set it to true, to fetch all pages containing all available records from Azure. ",
          "required": false,
          "editable": true,
          "visible": true,
          "value": false
        },
        {
          "title": "Skip Token",
          "required": false,
          "editable": true,
          "visible": true,
          "type": "text",
          "name": "$skipToken",
          "description": "(Optional) Specify a Skiptoken if a previous operation returned a partial result. If the previous response contains a nextLink element, the value of the nextLink element includes a skiptoken parameter that specifies a starting point to use for subsequent calls."
        }
      ],
      "enabled": true
    },
    {
      "title": "List Registered Owners",
      "operation": "get_registered_owners",
      "description": "Retrieves a list of users registered as owners of a device. ",
      "category": "investigation",
      "annotation": "get_registered_owners",
      "output_schema": {
        "@odata.context": "",
        "value": [
          {
            "@odata.type": "",
            "@odata.id": "",
            "id": ""
          }
        ]
      },
      "parameters": [
        {
          "title": "Device ID",
          "name": "device_id",
          "type": "text",
          "description": "Specify the device ID for which to fetch registered owners.",
          "tooltip": "Specify the device ID for which to fetch registered owners",
          "required": true,
          "editable": true,
          "visible": true
        }
      ],
      "enabled": true
    },
    {
      "title": "List Registered Users",
      "operation": "get_registered_users",
      "description": "Retrieves a list of registered users of a device.",
      "category": "investigation",
      "annotation": "get_registered_users",
      "output_schema": {
        "@odata.context": "",
        "value": [
          {
            "@odata.type": "",
            "@odata.id": "",
            "id": "",
            "displayName": "",
            "mail": "",
            "mailNickname": ""
          }
        ]
      },
      "parameters": [
        {
          "title": "Device ID",
          "name": "device_id",
          "type": "text",
          "description": "Specify the device ID for which to fetch registered owners. ",
          "tooltip": "Specify the device ID for which to fetch registered owners",
          "required": true,
          "editable": true,
          "visible": true
        }
      ],
      "enabled": true
    },
    {
      "title": "List Groups",
      "operation": "list_groups",
      "description": "Retrieves a list of groups from Azure Active Directory based on the query for filtering groups that you have specified.",
      "category": "investigation ",
      "annotation": "list_groups",
      "output_schema": {
        "@odata.context": "",
        "@odata.count": "",
        "value": [
          {
            "id": "",
            "deletedDateTime": "",
            "classification": "",
            "createdDateTime": "",
            "creationOptions": [
            ],
            "description": "",
            "displayName": "",
            "expirationDateTime": "",
            "groupTypes": [
            ],
            "isAssignableToRole": "",
            "mail": "",
            "mailEnabled": "",
            "mailNickname": "",
            "membershipRule": "",
            "membershipRuleProcessingState": "",
            "onPremisesDomainName": "",
            "onPremisesLastSyncDateTime": "",
            "onPremisesNetBiosName": "",
            "onPremisesSamAccountName": "",
            "onPremisesSecurityIdentifier": "",
            "onPremisesSyncEnabled": "",
            "preferredDataLocation": "",
            "preferredLanguage": "",
            "proxyAddresses": [
            ],
            "renewedDateTime": "",
            "resourceBehaviorOptions": [
            ],
            "resourceProvisioningOptions": [
            ],
            "securityEnabled": "",
            "securityIdentifier": "",
            "theme": "",
            "visibility": "",
            "onPremisesProvisioningErrors": [
            ]
          }
        ]
      },
      "parameters": [
        {
          "title": "Filter Query",
          "description": "Specify the filter query based on which you want to retrieve groups. Refer to Azure Filter Query Parameters for information on the filter query syntax. ",
          "required": false,
          "editable": true,
          "visible": true,
          "type": "text",
          "name": "$filter",
          "placeholder": "displayName eq 'FortiSOAR'",
          "tooltip": "Filter query based on which you want to retrieve groups as documented at https://learn.microsoft.com/en-us/graph/filter-query-parameter"
        },
        {
          "title": "Select Query",
          "description": "Specify the $select query to retrieve groups from Azure Active Directory. The OData's Select query is supported on fields such as id, displayName, etc. Refer to OData system query options for more information. ",
          "required": false,
          "editable": true,
          "visible": true,
          "type": "text",
          "name": "$select",
          "placeholder": "id,displayName",
          "tooltip": "Specify the select query to retrieve groups from Azure Active Directory. The OData's Select query is supported on fields such as: \"id\", \"displayName\", etc."
        },
        {
          "title": "Number Of Groups To Fetch",
          "required": false,
          "editable": true,
          "visible": true,
          "type": "integer",
          "name": "$top",
          "description": "(Optional) Specify the maximum number of groups that this operation should return from Azure. "
        },
        {
          "title": "Get All Pages",
          "name": "get_all_pages",
          "type": "checkbox",
          "tooltip": "If you select this option, i.e., set it to true, all pages will be fetched from azure so the action will return all available records.",
          "description": "Select this option, i.e., set it to true, to fetch all pages containing all available records from Azure.",
          "required": false,
          "editable": true,
          "visible": true,
          "value": false
        },
        {
          "title": "Skip Token",
          "required": false,
          "editable": true,
          "visible": true,
          "type": "text",
          "name": "$skipToken",
          "description": "(Optional) Specify a Skiptoken if a previous operation returned a partial result. If the previous response contains a nextLink element, the value of the nextLink element includes a skiptoken parameter that specifies a starting point to use for subsequent calls."
        }
      ],
      "enabled": true
    },
    {
      "title": "List Group Members",
      "operation": "list_group_members",
      "description": "Retrieves a list of members of a particular group from Azure Active Directory based on the query for filtering group members that you have specified. ",
      "category": "investigation ",
      "annotation": "list_group_members",
      "output_schema": {
        "@odata.context": "",
        "@odata.count": "",
        "value": [
          {
            "@odata.type": "",
            "id": "",
            "businessPhones": [
            ],
            "displayName": "",
            "givenName": "",
            "jobTitle": "",
            "mail": "",
            "mobilePhone": "",
            "officeLocation": "",
            "preferredLanguage": "",
            "surname": "",
            "userPrincipalName": ""
          }
        ]
      },
      "parameters": [
        {
          "title": "Group ID",
          "name": "id",
          "type": "text",
          "tooltip": "ID of the group for which you want to list the members",
          "description": "Specify an ID of the group for which you want to list the members. ",
          "required": true,
          "editable": true,
          "visible": true
        },
        {
          "title": "Filter Query",
          "description": "Specify the filter query based on which you want to retrieve group members. Refer to Azure Filter Query Parameters for information on the filter query syntax. ",
          "required": false,
          "editable": true,
          "visible": true,
          "type": "text",
          "name": "$filter",
          "placeholder": "displayName eq 'FortiSOAR'",
          "tooltip": "Filter query based on you want to retrieve group members as documented at https://learn.microsoft.com/en-us/graph/filter-query-parameter"
        },
        {
          "title": "Select Query",
          "description": "Specify the $select query to retrieve group members from Azure Active Directory. The OData's Select query is supported on fields such as id, userPrincipalName, displayName, etc.",
          "required": false,
          "editable": true,
          "visible": true,
          "type": "text",
          "name": "$select",
          "placeholder": "id,displayName",
          "tooltip": "Specify the select query to retrieve group members from Azure Active Directory. The OData's Select query is supported on fields such as: \"id\", \"userPrincipalName\", \"displayName\", etc. Allowed properties: businessPhones,displayName,givenName,jobTitle,mail,mobilePhone,officeLocation,preferredLanguage,surname,userPrincipalName,accountEnabled,ageGroup,assignedLicenses,assignedPlans,city,companyName,consentProvidedForMinor,country,createdDateTime,creationType,deletedDateTime,department,employeeHireDate,employeeId,employeeOrgData,employeeType,externalUserState,externalUserStateChangeDateTime,faxNumber,id,identities,imAddresses,isResourceAccount,lastPasswordChangeDateTime,legalAgeGroupClassification,licenseAssignmentStates,mailNickname,onPremisesDistinguishedName,onPremisesDomainName,onPremisesExtensionAttributes,onPremisesImmutableId,onPremisesLastSyncDateTime,onPremisesProvisioningErrors,onPremisesSamAccountName,onPremisesSecurityIdentifier,onPremisesSyncEnabled,onPremisesUserPrincipalName,otherMails,passwordPolicies,passwordProfile,postalCode,preferredDataLocation,provisionedPlans,proxyAddresses,refreshTokensValidFromDateTime,securityIdentifier,showInAddressList,signInSessionsValidFromDateTime,state,streetAddress,usageLocation"
        },
        {
          "title": "Number Of Group Members To Fetch",
          "required": false,
          "editable": true,
          "visible": true,
          "type": "integer",
          "name": "$top",
          "description": "(Optional) Specify the maximum number of group members that this operation should return from Azure."
        },
        {
          "title": "Get All Pages",
          "name": "get_all_pages",
          "type": "checkbox",
          "tooltip": "If you select this option, i.e., set it to true, all pages will be fetched from azure so the action will return all available records.",
          "description": "Select this option, i.e., set it to true, to fetch all pages containing all available records from Azure. ",
          "required": false,
          "editable": true,
          "visible": true,
          "value": false
        },
        {
          "title": "Skip Token",
          "required": false,
          "editable": true,
          "visible": true,
          "type": "text",
          "name": "$skipToken",
          "description": "(Optional) Specify a Skiptoken if a previous operation returned a partial result. If the previous response contains a nextLink element, the value of the nextLink element includes a skiptoken parameter that specifies a starting point to use for subsequent calls."
        }
      ],
      "enabled": true
    },
    {
      "title": "Get Group Details",
      "operation": "get_group_details",
      "description": "Retrieves the details of a particular group from Azure Active Directory based on the group ID that you have specified. ",
      "category": "investigation ",
      "annotation": "get_group_details",
      "output_schema": {
        "@odata.context": "",
        "id": "",
        "deletedDateTime": "",
        "classification": "",
        "createdDateTime": "",
        "creationOptions": [
        ],
        "description": "",
        "displayName": "",
        "expirationDateTime": "",
        "groupTypes": [
        ],
        "isAssignableToRole": "",
        "mail": "",
        "mailEnabled": "",
        "mailNickname": "",
        "membershipRule": "",
        "membershipRuleProcessingState": "",
        "onPremisesDomainName": "",
        "onPremisesLastSyncDateTime": "",
        "onPremisesNetBiosName": "",
        "onPremisesSamAccountName": "",
        "onPremisesSecurityIdentifier": "",
        "onPremisesSyncEnabled": "",
        "preferredDataLocation": "",
        "preferredLanguage": "",
        "proxyAddresses": [
        ],
        "renewedDateTime": "",
        "resourceBehaviorOptions": [
        ],
        "resourceProvisioningOptions": [
        ],
        "securityEnabled": "",
        "securityIdentifier": "",
        "theme": "",
        "visibility": "",
        "onPremisesProvisioningErrors": [
        ]
      },
      "parameters": [
        {
          "title": "Group ID",
          "name": "id",
          "type": "text",
          "tooltip": "Group ID to fetch the details of the group",
          "description": "Specify a group ID to fetch the details for that group. ",
          "required": true,
          "editable": true,
          "visible": true
        }
      ],
      "enabled": true
    },
    {
      "title": "Remove Member",
      "operation": "remove_member",
      "description": "Removes a member from a group based on the group and user ID that you have specified. ",
      "category": "investigation ",
      "annotation": "remove_member",
      "output_schema": {
        "status": "",
        "result": ""
      },
      "parameters": [
        {
          "title": "Group ID",
          "name": "id",
          "type": "text",
          "tooltip": "ID to of the group from which you want to remove the user",
          "description": "Specify a group ID from which you want to remove the user. ",
          "required": true,
          "editable": true,
          "visible": true
        },
        {
          "title": "User ID",
          "name": "dir_object_id",
          "type": "text",
          "tooltip": "Directory Object ID of the user to remove from the group.",
          "description": "Specify the directory object ID of the user to remove from the group.",
          "required": true,
          "editable": true,
          "visible": true
        }
      ],
      "enabled": true
    },
    {
      "title": "Add Member",
      "operation": "add_member",
      "description": "Adds a member to a group based on the group and user ID that you have specified. ",
      "category": "investigation ",
      "annotation": "add_member",
      "output_schema": {
        "status": "",
        "result": ""
      },
      "parameters": [
        {
          "title": "Group ID",
          "name": "id",
          "type": "text",
          "tooltip": "ID to of the group to which you want to add a user",
          "description": "Specify a group ID to which you want to add a user. ",
          "required": true,
          "editable": true,
          "visible": true
        },
        {
          "title": "User ID",
          "name": "dir_object_id",
          "type": "text",
          "tooltip": "Directory Object ID of the user you want to add to the group.",
          "description": "Specify the directory object ID of the user to add to the group. ",
          "required": true,
          "editable": true,
          "visible": true
        }
      ],
      "enabled": true
    },
    {
      "title": "List SignIns Events",
      "operation": "list_sign_ins",
      "description": "Retrieves the list of sign-in events from Azure Active Directory based on the query for filtering users that you have specified. ",
      "category": "investigation ",
      "annotation": "list_sign_ins",
      "output_schema": {
        "@odata.context": "",
        "@odata.nextLink": "",
        "value": [
          {
            "id": "",
            "createdDateTime": "",
            "userDisplayName": "",
            "userPrincipalName": "",
            "userId": "",
            "appId": "",
            "appDisplayName": "",
            "ipAddress": "",
            "clientAppUsed": "",
            "correlationId": "",
            "conditionalAccessStatus": "",
            "isInteractive": "",
            "riskDetail": "",
            "riskLevelAggregated": "",
            "riskLevelDuringSignIn": "",
            "riskState": "",
            "riskEventTypes": [
            ],
            "riskEventTypes_v2": [
            ],
            "resourceDisplayName": "",
            "resourceId": "",
            "status": {
              "errorCode": "",
              "failureReason": "",
              "additionalDetails": ""
            },
            "deviceDetail": {
              "deviceId": "",
              "displayName": "",
              "operatingSystem": "",
              "browser": "",
              "isCompliant": "",
              "isManaged": "",
              "trustType": ""
            },
            "location": {
              "city": "",
              "state": "",
              "countryOrRegion": "",
              "geoCoordinates": {
                "altitude": "",
                "latitude": "",
                "longitude": ""
              }
            },
            "appliedConditionalAccessPolicies": [
            ]
          }
        ]
      },
      "parameters": [
        {
          "title": "Filter Query",
          "description": "Specify the filter query based on which you want to retrieve sign-in events from Azure Active Directory. The OData's Filter query is supported on the following fields: id, userPrincipalName, displayName, givenName and jobTitle. For example [userPrincipalName eq 'username@example.com'] retrieves a user whose userPrincipalName is username@example.com. Refer to OData system query options for more information.",
          "required": false,
          "editable": true,
          "visible": true,
          "type": "text",
          "name": "$filter",
          "placeholder": "userPrincipalName eq 'username@fortisoar1.onmicrosoft.com'",
          "tooltip": "Filter query based on which you want to retrieve sign-in events from Azure Active Directory. The OData's Filter query is supported on the following fields: \"id\", \"userPrincipalName\", \"displayName\", \"givenName\" and \"jobTitle\". For example [userPrincipalName eq 'username@fortisoar1.onmicrosoft.com'] retrieve a user which userPrincipalName is username@fortisoar1.onmicrosoft.com"
        },
        {
          "title": "Number of Events to Fetch",
          "required": false,
          "editable": true,
          "visible": true,
          "type": "integer",
          "name": "$top",
          "description": "(Optional) Specify the maximum number of events that this operation should return from Azure. "
        },
        {
          "title": "Get All Pages",
          "name": "get_all_pages",
          "type": "checkbox",
          "tooltip": "If you select this option, i.e., set it to true, all pages will be fetched from azure so the action will return all available records.",
          "description": "Select this option, i.e., set it to true, to fetch all pages containing all available records from Azure. ",
          "required": false,
          "editable": true,
          "visible": true,
          "value": false
        },
        {
          "title": "Skip Token",
          "required": false,
          "editable": true,
          "visible": true,
          "type": "text",
          "name": "$skipToken",
          "description": "(Optional) Specify a Skiptoken if a previous operation returned a partial result. If the previous response contains a nextLink element, the value of the nextLink element includes a skiptoken parameter that specifies a starting point to use for subsequent calls. "
        }
      ],
      "enabled": true
    },
    {
      "title": "List Users",
      "operation": "list_users",
      "description": "Retrieves a list of users from Azure Active Directory based on the query for filtering users you have specified. ",
      "category": "investigation ",
      "annotation": "list_users",
      "output_schema": {
        "@odata.context": "",
        "@odata.count": "",
        "value": [
          {
            "businessPhones": [
            ],
            "displayName": "",
            "givenName": "",
            "jobTitle": "",
            "mail": "",
            "mobilePhone": "",
            "officeLocation": "",
            "preferredLanguage": "",
            "surname": "",
            "userPrincipalName": "",
            "id": ""
          }
        ]
      },
      "parameters": [
        {
          "title": "Filter Query",
          "description": "Specify the filter query based on which you want to retrieve users from Azure Active Directory. The OData's Filter query is supported on the following fields: id, userPrincipalName, displayName, givenName and jobTitle. For example [userPrincipalName eq \"username@example.com\"] retrieves a user whose userPrincipalName is username@example.com ",
          "required": false,
          "editable": true,
          "visible": true,
          "type": "text",
          "name": "$filter",
          "placeholder": "userPrincipalName eq 'username@fortisoar1.onmicrosoft.com'",
          "tooltip": "Filter query based on which you want to retrieve users from Azure Active Directory. The OData's Filter query is supported on the following fields: \"id\", \"userPrincipalName\", \"displayName\", \"givenName\" and \"jobTitle\". For example [userPrincipalName eq 'username@fortisoar1.onmicrosoft.com'] retrieve a user which userPrincipalName is username@fortisoar1.onmicrosoft.com"
        },
        {
          "title": "Select Query",
          "description": "Specify the $select query to retrieve user fields from Azure Active Directory. The OData's Select query is supported on fields such as id, userPrincipalName, displayName, etc. Refer to OData system query options for more information. ",
          "required": false,
          "editable": true,
          "visible": true,
          "type": "text",
          "name": "$select",
          "placeholder": "id,displayName",
          "tooltip": "Specify the select query to retrieve user fields from Azure Active Directory. The OData's Select query is supported on fields such as: \"id\", \"userPrincipalName\", \"displayName\", etc."
        },
        {
          "title": "Number Of Users To Fetch",
          "required": false,
          "editable": true,
          "visible": true,
          "type": "integer",
          "name": "$top",
          "description": "(Optional) Maximum number of users that this operation should return from Azure."
        },
        {
          "title": "Get All Pages",
          "name": "get_all_pages",
          "type": "checkbox",
          "tooltip": "If you select this option, i.e., set it to true, all pages will be fetched from azure so the action will return all available records.",
          "description": "If you select this option, i.e., set it to true, all pages will be fetched from azure so the action will return all available records.",
          "required": false,
          "editable": true,
          "visible": true,
          "value": false
        },
        {
          "title": "Skip Token",
          "required": false,
          "editable": true,
          "visible": true,
          "type": "text",
          "name": "$skipToken",
          "description": "(Optional) Skiptoken is only used if a previous operation returned a partial result. If a previous response contains a nextLink element, the value of the nextLink element will include a skiptoken parameter that specifies a starting point to use for subsequent calls."
        }
      ],
      "enabled": true
    },
    {
      "title": "Get User Details",
      "operation": "get_user_details",
      "description": "Retrieves specific information for a specific user from Azure Active Directory, based on the Object ID or User Principal Name you have specified.",
      "category": "investigation",
      "annotation": "get_user_details",
      "output_schema": {
        "@odata.context": "",
        "businessPhones": [
        ],
        "displayName": "",
        "givenName": "",
        "jobTitle": "",
        "mail": "",
        "mobilePhone": "",
        "officeLocation": "",
        "preferredLanguage": "",
        "surname": "",
        "userPrincipalName": "",
        "id": ""
      },
      "parameters": [
        {
          "title": "Based On",
          "name": "based_on",
          "type": "select",
          "tooltip": "Select the parameter based on which you want to retrieve details of a user from Azure Active Directory. You can choose between Object ID or User Principal Name.",
          "description": "Select the parameter based on which you want to retrieve details of a user from Azure Active Directory. You can choose between Object ID or User Principal Name.",
          "required": true,
          "editable": true,
          "visible": true,
          "options": [
            "Object ID",
            "User Principal Name"
          ],
          "value": "Object ID",
          "onchange": {
            "Object ID": [
              {
                "title": "Object ID",
                "name": "id",
                "type": "text",
                "tooltip": "If you choose Object ID, then in the Object ID field, you must specify the ID of the object based on which details of the user are retrieved from Azure Active Directory.",
                "description": "Specify the object ID of the user whose details are to be retrieved from Azure Active Directory.",
                "required": true,
                "editable": true,
                "visible": true
              }
            ],
            "User Principal Name": [
              {
                "title": "User Principal Name",
                "name": "id",
                "type": "text",
                "tooltip": "If you choose User Principal Name, then in the User Principal Name field, you must specify the principal name of the user whose details you want to retrieve from Azure Active Directory.",
                "description": "Specify the principal name of the user whose details are to be retrieved from Azure Active Directory.",
                "required": true,
                "editable": true,
                "visible": true
              }
            ]
          }
        }
      ],
      "enabled": true
    },
    {
      "title": "Add User",
      "operation": "add_user",
      "description": "Creates a new user in Azure Active Directory, based on the User Principal Name, Display Name, Password, and other input parameters you have specified.",
      "category": "investigation",
      "annotation": "add_user",
      "output_schema": {
        "@odata.context": "",
        "id": "",
        "businessPhones": [
        ],
        "displayName": "",
        "givenName": "",
        "jobTitle": "",
        "mail": "",
        "mobilePhone": "",
        "officeLocation": "",
        "preferredLanguage": "",
        "surname": "",
        "userPrincipalName": ""
      },
      "parameters": [
        {
          "title": "Display Name",
          "name": "displayName",
          "type": "text",
          "tooltip": "Name that you want to display in the address book for the user that you are creating in Azure Active Directory.",
          "description": "Specify the name that you want to be displayed in the address book for the user that you are creating in Azure Active Directory. ",
          "required": true,
          "editable": true,
          "visible": true
        },
        {
          "title": "Mail Nick Name",
          "name": "mailNickname",
          "type": "text",
          "tooltip": "Mail alias for the user that you are creating in Azure Active Directory.",
          "description": "Specify the mail alias for the user that you are creating in Azure Active Directory. ",
          "required": true,
          "editable": true,
          "visible": true
        },
        {
          "title": "User Principal Name",
          "name": "userPrincipalName",
          "type": "text",
          "description": "Specify the principal name of the user that you are creating in Azure Active Directory. ",
          "tooltip": "Principal name of the user that you are creating in Azure Active Directory.",
          "required": true,
          "editable": true,
          "visible": true,
          "placeholder": "someuser@contoso.com"
        },
        {
          "title": "Password",
          "name": "password",
          "type": "password",
          "tooltip": "Password of the user that you are creating in Azure Active Directory.",
          "description": "Specify the password of the user that you are creating in Azure Active Directory. ",
          "required": true,
          "editable": true,
          "visible": true
        },
        {
          "title": "Force Change Password Next Login",
          "name": "force_change",
          "type": "checkbox",
          "tooltip": "If you select this option, i.e., set it to true, then the user is forced to change his password when the users next logs into Azure Active Directory.",
          "description": "Select this option, i.e., set it to true, to force the users to change their password when they next log on to Azure Active Directory. ",
          "required": false,
          "editable": true,
          "visible": true,
          "value": true
        },
        {
          "title": "Account Enabled",
          "name": "accountEnabled",
          "type": "checkbox",
          "tooltip": "If you select this option, i.e., set it to true, then the user's account is enabled on Azure Active Directory.",
          "description": "Select this option, i.e., set it to true, to enable this user's account on Azure Active Directory. ",
          "required": false,
          "editable": true,
          "visible": true,
          "value": true
        },
        {
          "title": "Additional Fields",
          "name": "additional_fields",
          "type": "json",
          "required": false,
          "editable": true,
          "visible": true,
          "value": "",
          "tooltip": "(Optional) Additional fields that you want to add to the user that you are creating in Azure Active Directory.",
          "description": "(Optional) Specify additional fields to add to the user's account that you are creating in Azure Active Directory. "
        }
      ],
      "enabled": true
    },
    {
      "title": "Enable User",
      "operation": "enable_user",
      "description": "Enables a specific user's account in Azure Active Directory, based on the Object ID or User Principal Name you have specified.",
      "category": "containment",
      "annotation": "enable_user",
      "output_schema": {
        "result": "",
        "status": ""
      },
      "parameters": [
        {
          "title": "Based On",
          "name": "based_on",
          "type": "select",
          "tooltip": "Select the parameter based on which you want to enable a user's account on Azure Active Directory. You can choose between Object ID or User Principal Name.",
          "description": "Select the parameter based on which you want to enable a user's account on Azure Active Directory. You can choose between Object ID or User Principal Name.",
          "required": true,
          "editable": true,
          "visible": true,
          "options": [
            "Object ID",
            "User Principal Name"
          ],
          "value": "Object ID",
          "onchange": {
            "Object ID": [
              {
                "title": "Object ID",
                "name": "id",
                "type": "text",
                "tooltip": "If you choose Object ID, then in the Object ID field, you must specify the ID of the object based on which user account is enabled on Azure Active Directory.",
                "description": "Specify the object ID associated with the user account to be enabled on Azure Active Directory.",
                "required": true,
                "editable": true,
                "visible": true
              }
            ],
            "User Principal Name": [
              {
                "title": "User Principal Name",
                "name": "id",
                "type": "text",
                "tooltip": "If you choose User Principal Name, then in the User Principal Name field, you must specify the principal name of the user based on which user account is enabled on Azure Active Directory.",
                "description": "Specify the principal name associated with the user account to be enabled on Azure Active Directory.",
                "required": true,
                "editable": true,
                "visible": true
              }
            ]
          }
        }
      ],
      "enabled": true
    },
    {
      "title": "Disable User",
      "operation": "disable_user",
      "description": "Disables a specific user's account in Azure Active Directory, based on the Object ID or User Principal Name you have specified.",
      "category": "containment",
      "annotation": "disable_user",
      "output_schema": {
        "result": "",
        "status": ""
      },
      "parameters": [
        {
          "title": "Based On",
          "name": "based_on",
          "type": "select",
          "tooltip": "Select the parameter based on which you want to disable a user's account on Azure Active Directory. You can choose between Object ID or User Principal Name.",
          "description": "Select the parameter based on which you want to disable a user's account on Azure Active Directory. You can choose between Object ID or User Principal Name.",
          "required": true,
          "editable": true,
          "visible": true,
          "options": [
            "Object ID",
            "User Principal Name"
          ],
          "value": "Object ID",
          "onchange": {
            "Object ID": [
              {
                "title": "Object ID",
                "name": "id",
                "type": "text",
                "tooltip": "If you choose Object ID, then in the Object ID field, you must specify the ID of the object based on which user account is disabled on Azure Active Directory.",
                "description": "Specify the object ID associated with the user account to be disabled on Azure Active Directory.",
                "required": true,
                "editable": true,
                "visible": true
              }
            ],
            "User Principal Name": [
              {
                "title": "User Principal Name",
                "name": "id",
                "type": "text",
                "tooltip": "If you choose User Principal Name, then in the User Principal Name field, you must specify the principal name of the user based on which user account is disabled on Azure Active Directory.",
                "description": "Specify the principal name associated with the user account to be disabled on Azure Active Directory.",
                "required": true,
                "editable": true,
                "visible": true
              }
            ]
          }
        }
      ],
      "enabled": true
    },
    {
      "title": "Delete User",
      "operation": "delete_user",
      "description": "Deletes a specific user's account from Azure Active Directory, based on the Object ID or User Principal Name you have specified.",
      "category": "investigation",
      "annotation": "delete_user",
      "output_schema": {
        "result": "",
        "status": ""
      },
      "parameters": [
        {
          "title": "Based On",
          "name": "based_on",
          "type": "select",
          "tooltip": "Select the parameter based on which you want to delete a user's account from Azure Active Directory. You can choose between Object ID or User Principal Name.",
          "description": "Select the parameter based on which you want to delete a user's account from Azure Active Directory. You can choose between Object ID or User Principal Name.",
          "required": true,
          "editable": true,
          "visible": true,
          "options": [
            "Object ID",
            "User Principal Name"
          ],
          "value": "Object ID",
          "onchange": {
            "Object ID": [
              {
                "title": "Object ID",
                "name": "id",
                "type": "text",
                "tooltip": "If you choose Object ID, then in the Object ID field, you must specify the ID of the object based on which user account is deleted from Azure Active Directory.",
                "description": "Specify the object ID associated with the user account to be deleted on Azure Active Directory.",
                "required": true,
                "editable": true,
                "visible": true
              }
            ],
            "User Principal Name": [
              {
                "title": "User Principal Name",
                "name": "id",
                "type": "text",
                "tooltip": "If you choose User Principal Name, then in the User Principal Name field, you must specify the principal name of the user based on which user account is deleted from Azure Active Directory.",
                "description": "Specify the principal name associated with the user account to be deleted on Azure Active Directory.",
                "required": true,
                "editable": true,
                "visible": true
              }
            ]
          }
        }
      ],
      "enabled": true
    },
    {
      "title": "Reset Password",
      "operation": "reset_password",
      "description": "Resets the password for an existing Azure Active Directory user, based on the Object ID or User Principal Name, password, and other input parameters you have specified.",
      "category": "containment",
      "annotation": "reset_password",
      "output_schema": {
        "result": "",
        "status": ""
      },
      "parameters": [
        {
          "title": "Based On",
          "name": "based_on",
          "type": "select",
          "tooltip": "Select the parameter based on which you want to retrieve details of the user, whose password you want to reset, from Azure Active Directory. You can choose between Object ID or User Principal Name.",
          "description": "Select the parameter based on which you want to reset the password of a user's account on Azure Active Directory You can choose between Object ID or User Principal Name.",
          "required": true,
          "editable": true,
          "visible": true,
          "options": [
            "Object ID",
            "User Principal Name"
          ],
          "value": "Object ID",
          "onchange": {
            "Object ID": [
              {
                "title": "Object ID",
                "name": "id",
                "type": "text",
                "tooltip": "If you choose Object ID, then in the Object ID field, you must specify the ID of the object based on which details of the user are retrieved from Azure Active Directory.",
                "description": "Specify the object ID associated with the user account whose password is to be reset on Azure Active Directory. ",
                "required": true,
                "editable": true,
                "visible": true
              }
            ],
            "User Principal Name": [
              {
                "title": "User Principal Name",
                "name": "id",
                "type": "text",
                "tooltip": "If you choose User Principal Name, then in the User Principal Name field, you must specify the principal name of the user whose details you want to retrieve from Azure Active Directory.",
                "description": "Specify the principal name associated with the user account whose password is to be reset on Azure Active Directory. ",
                "required": true,
                "editable": true,
                "visible": true
              }
            ]
          }
        },
        {
          "title": "Password",
          "name": "password",
          "type": "password",
          "tooltip": "Temporary password that you want to set for the user whose password you want to rest on Azure Active Directory.",
          "description": "Specify a temporary password that you want to set for the user on Azure Active Directory. ",
          "required": true,
          "editable": true,
          "visible": true,
          "value": true
        },
        {
          "title": "Force Change Password Next Login",
          "name": "force_change",
          "type": "checkbox",
          "tooltip": "If you select this option, i.e., set it to true, then the user is forced to change his password when the user next logs into Azure Active Directory.",
          "description": "Select this option, i.e., set it to true, to force the users to change their password when they next log on to Azure Active Directory. ",
          "required": false,
          "editable": true,
          "visible": true
        }
      ],
      "enabled": true
    }
  ]
}